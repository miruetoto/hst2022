<!DOCTYPE html>
<html lang="en"><head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="twitter:card" content="summary_large_image" /><!-- Begin Jekyll SEO tag v2.8.0 -->
<title>(연구) HST example 1 (1) | hst</title>
<meta name="generator" content="Jekyll v4.1.1" />
<meta property="og:title" content="(연구) HST example 1 (1)" />
<meta name="author" content="신록예찬" />
<meta property="og:locale" content="en_US" />
<link rel="canonical" href="https://miruetoto.github.io/hst2022/%EB%85%BC%EB%AC%B8%EC%97%B0%EA%B5%AC/2021/08/02/(%EC%97%B0%EA%B5%AC)-HST-example-1-(1)-%EB%85%BC%EB%AC%B8%EC%97%B0%EA%B5%AC.html" />
<meta property="og:url" content="https://miruetoto.github.io/hst2022/%EB%85%BC%EB%AC%B8%EC%97%B0%EA%B5%AC/2021/08/02/(%EC%97%B0%EA%B5%AC)-HST-example-1-(1)-%EB%85%BC%EB%AC%B8%EC%97%B0%EA%B5%AC.html" />
<meta property="og:site_name" content="hst" />
<meta property="og:type" content="article" />
<meta property="article:published_time" content="2021-08-02T00:00:00-05:00" />
<meta name="twitter:card" content="summary" />
<meta property="twitter:title" content="(연구) HST example 1 (1)" />
<script type="application/ld+json">
{"@context":"https://schema.org","@type":"BlogPosting","author":{"@type":"Person","name":"신록예찬"},"dateModified":"2021-08-02T00:00:00-05:00","datePublished":"2021-08-02T00:00:00-05:00","headline":"(연구) HST example 1 (1)","mainEntityOfPage":{"@type":"WebPage","@id":"https://miruetoto.github.io/hst2022/%EB%85%BC%EB%AC%B8%EC%97%B0%EA%B5%AC/2021/08/02/(%EC%97%B0%EA%B5%AC)-HST-example-1-(1)-%EB%85%BC%EB%AC%B8%EC%97%B0%EA%B5%AC.html"},"url":"https://miruetoto.github.io/hst2022/%EB%85%BC%EB%AC%B8%EC%97%B0%EA%B5%AC/2021/08/02/(%EC%97%B0%EA%B5%AC)-HST-example-1-(1)-%EB%85%BC%EB%AC%B8%EC%97%B0%EA%B5%AC.html"}</script>
<!-- End Jekyll SEO tag -->
<link rel="stylesheet" href="/hst2022/assets/css/style.css"><link type="application/atom+xml" rel="alternate" href="https://miruetoto.github.io/hst2022/feed.xml" title="hst" /><link rel="shortcut icon" type="image/x-icon" href="/hst2022/images/favicon.ico"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/Primer/15.2.0/primer.css" integrity="sha512-xTz2ys4coGAOz8vuV1NcQBkgVmKhsSEtjbqyMJbBHRplFuvKIUo6xhLHpAyPt9mfR6twHJgn9OgVLuqOvjeBhg==" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.14.0/css/all.min.css" integrity="sha512-1PKOgIY59xJ8Co8+NE6FZ+LOAZKjy+KY8iq0G4B3CyeY6wYHN3yt9PW0XpSriVlkMXe40PTKnXrLnZ9+fkDaog==" crossorigin="anonymous" />
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.12.0/katex.min.css" integrity="sha512-h7nl+xz8wgDlNM4NqKEM4F1NkIRS17M9+uJwIGwuo8vGqIl4BhuCKdxjWEINm+xyrUjNCnK5dCrhM0sj+wTIXw==" crossorigin="anonymous" />
    <script src="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.12.0/katex.min.js" integrity="sha512-/CMIhXiDA3m2c9kzRyd97MTb3MC6OVnx4TElQ7fkkoRghwDf6gi41gaT1PwF270W6+J60uTmwgeRpNpJdRV6sg==" crossorigin="anonymous"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.12.0/contrib/auto-render.min.js" integrity="sha512-Do7uJAaHZm5OLrIv/yN4w0iG1dbu01kzdMNnFfu/mAqgUk6Nniv2JYHcwH+cNwjqgLcqcuBBk+JRvprLVI8azg==" crossorigin="anonymous"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha512-0doc9hKxR3PYwso42RD1p5ySZpzzuDiOwMrdCEh2WdJZCjcmFKc/wEnL+z8fBQrnHoiNWbo+3fiGkOYXBdQp4A==" crossorigin="anonymous"></script>
    <script>
    document.addEventListener("DOMContentLoaded", function() {
        renderMathInElement( document.body, {
        delimiters: [
            {left: "$$", right: "$$", display: true},
            {left: "[%", right: "%]", display: true},
            {left: "$", right: "$", display: false}
        ]}
        );
    });
    </script>


<script>
function wrap_img(fn) {
    if (document.attachEvent ? document.readyState === "complete" : document.readyState !== "loading") {
        var elements = document.querySelectorAll(".post img");
        Array.prototype.forEach.call(elements, function(el, i) {
            if (el.getAttribute("title") && (el.className != "emoji")) {
                const caption = document.createElement('figcaption');
                var node = document.createTextNode(el.getAttribute("title"));
                caption.appendChild(node);
                const wrapper = document.createElement('figure');
                wrapper.className = 'image';
                el.parentNode.insertBefore(wrapper, el);
                el.parentNode.removeChild(el);
                wrapper.appendChild(el);
                wrapper.appendChild(caption);
            }
        });
    } else { document.addEventListener('DOMContentLoaded', fn); }
}
window.onload = wrap_img;
</script>

<script>
    document.addEventListener("DOMContentLoaded", function(){
    // add link icon to anchor tags
    var elem = document.querySelectorAll(".anchor-link")
    elem.forEach(e => (e.innerHTML = '<i class="fas fa-link fa-xs"></i>'));
    });
</script>
</head>
<body><header class="site-header">

  <div class="wrapper"><a class="site-title" rel="author" href="/hst2022/">hst</a><nav class="site-nav">
        <input type="checkbox" id="nav-trigger" class="nav-trigger" />
        <label for="nav-trigger">
          <span class="menu-icon">
            <svg viewBox="0 0 18 15" width="18px" height="15px">
              <path d="M18,1.484c0,0.82-0.665,1.484-1.484,1.484H1.484C0.665,2.969,0,2.304,0,1.484l0,0C0,0.665,0.665,0,1.484,0 h15.032C17.335,0,18,0.665,18,1.484L18,1.484z M18,7.516C18,8.335,17.335,9,16.516,9H1.484C0.665,9,0,8.335,0,7.516l0,0 c0-0.82,0.665-1.484,1.484-1.484h15.032C17.335,6.031,18,6.696,18,7.516L18,7.516z M18,13.516C18,14.335,17.335,15,16.516,15H1.484 C0.665,15,0,14.335,0,13.516l0,0c0-0.82,0.665-1.483,1.484-1.483h15.032C17.335,12.031,18,12.695,18,13.516L18,13.516z"/>
            </svg>
          </span>
        </label>

        <div class="trigger"><a class="page-link" href="/hst2022/about/">About Me</a><a class="page-link" href="/hst2022/search/">Search</a><a class="page-link" href="/hst2022/categories/">Tags</a></div>
      </nav></div>
</header>
<main class="page-content" aria-label="Content">
      <div class="wrapper">
        <article class="post h-entry" itemscope itemtype="http://schema.org/BlogPosting">

  <header class="post-header">
    <h1 class="post-title p-name" itemprop="name headline">(연구) HST example 1 (1)</h1><p class="post-meta post-meta-title"><time class="dt-published" datetime="2021-08-02T00:00:00-05:00" itemprop="datePublished">
        Aug 2, 2021
      </time>• 
          <span itemprop="author" itemscope itemtype="http://schema.org/Person">
            <span class="p-author h-card" itemprop="name">신록예찬</span></span>
       • <span class="read-time" title="Estimated read time">
    
    
      4 min read
    
</span></p>

    
      <p class="category-tags"><i class="fas fa-tags category-tags-icon"></i></i> 
      
        <a class="category-tags-link" href="/hst2022/categories/#논문연구">논문연구</a>
        
      
      </p>
    

    
      
        <div class="pb-5 d-flex flex-justify-center">
          <div class="px-2">

    <a href="https://github.com/miruetoto/hst2022/tree/master/_notebooks/2021-08-02-(연구) HST example 1 (1) [논문연구].ipynb" role="button" target="_blank">
<img class="notebook-badge-image" src="/hst2022/assets/badges/github.svg" alt="View On GitHub">
    </a>
</div>

          <div class="px-2">
    <a href="https://mybinder.org/v2/gh/miruetoto/hst2022/master?filepath=_notebooks%2F2021-08-02-%28%EC%97%B0%EA%B5%AC%29+HST+example+1+%281%29+%5B%EB%85%BC%EB%AC%B8%EC%97%B0%EA%B5%AC%5D.ipynb" target="_blank">
        <img class="notebook-badge-image" src="/hst2022/assets/badges/binder.svg" alt="Open In Binder"/>
    </a>
</div>

          <div class="px-2">
    <a href="https://colab.research.google.com/github/miruetoto/hst2022/blob/master/_notebooks/2021-08-02-(연구) HST example 1 (1) [논문연구].ipynb" target="_blank">
        <img class="notebook-badge-image" src="/hst2022/assets/badges/colab.svg" alt="Open In Colab"/>
    </a>
</div>
          <div class="px-2">
  <a href="https://deepnote.com/launch?url=https%3A%2F%2Fgithub.com%2Fmiruetoto%2Fhst2022%2Fblob%2Fmaster%2F_notebooks%2F2021-08-02-%28%EC%97%B0%EA%B5%AC%29+HST+example+1+%281%29+%5B%EB%85%BC%EB%AC%B8%EC%97%B0%EA%B5%AC%5D.ipynb" target="_blank">
      <img class="notebook-badge-image" src="/hst2022/assets/badges/deepnote.svg" alt="Launch in Deepnote"/>
  </a>
</div>

        </div>
      </header>

  <div class="post-content e-content" itemprop="articleBody">
    <ul id="toc" class="section-nav">
<li class="toc-entry toc-h3"><a href="#Import">Import </a></li>
<li class="toc-entry toc-h3"><a href="#Data">Data </a></li>
<li class="toc-entry toc-h3"><a href="#HST">HST </a></li>
<li class="toc-entry toc-h3"><a href="#시각화를-위해서-R로-자료를-옮김">시각화를 위해서 R로 자료를 옮김 </a></li>
<li class="toc-entry toc-h3"><a href="#R을-활용한-시각화-(1):-원래자료">R을 활용한 시각화 (1): 원래자료 </a></li>
<li class="toc-entry toc-h3"><a href="#R을-활용한-시각화-(2):-Weight-matrix-와-Eigen-plot">R을 활용한 시각화 (2): Weight matrix 와 Eigen plot </a></li>
<li class="toc-entry toc-h3"><a href="#R을-활용한-시각화-(3):-Decomposition">R을 활용한 시각화 (3): Decomposition </a></li>
</ul><!--
#################################################
### THIS FILE WAS AUTOGENERATED! DO NOT EDIT! ###
#################################################
# file to edit: _notebooks/2021-08-02-(연구) HST example 1 (1) [논문연구].ipynb
-->

<div class="container" id="notebook-container">
        
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Import">
<a class="anchor" href="#Import" aria-hidden="true"><span class="octicon octicon-link"></span></a>Import<a class="anchor-link" href="#Import"> </a>
</h3>
</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <span class="nn">rpy2</span> 
<span class="o">%</span><span class="k">load_ext</span> rpy2.ipython
<span class="o">%</span><span class="k">run</span> pybase
<span class="o">%</span><span class="k">run</span> heavysnow 
</pre></div>

    </div>
</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Data">
<a class="anchor" href="#Data" aria-hidden="true"><span class="octicon octicon-link"></span></a>Data<a class="anchor-link" href="#Data"> </a>
</h3>
</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">f</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">])</span><span class="o">*</span><span class="mf">1.0</span>
<span class="n">n</span><span class="o">=</span><span class="nb">len</span><span class="p">(</span><span class="n">f</span><span class="p">)</span>
<span class="n">V</span><span class="o">=</span><span class="nb">list</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="n">n</span><span class="p">))</span>
<span class="n">W</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">([</span><span class="n">n</span><span class="p">,</span><span class="n">n</span><span class="p">])</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n</span><span class="p">):</span>
    <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n</span><span class="p">):</span>
        <span class="k">if</span> <span class="nb">abs</span><span class="p">(</span><span class="n">i</span><span class="o">-</span><span class="n">j</span><span class="p">)</span><span class="o">==</span><span class="mi">1</span><span class="p">:</span> <span class="n">W</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">]</span><span class="o">=</span><span class="mi">1</span>
<span class="n">W</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">]</span><span class="o">=</span><span class="mi">0</span>
<span class="n">W</span><span class="p">[</span><span class="n">n</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="n">n</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">=</span><span class="mi">0</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">gs</span><span class="o">=</span><span class="n">GraphSignal</span><span class="p">(</span><span class="n">V</span><span class="p">,</span><span class="n">W</span><span class="p">,</span><span class="n">f</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">gs</span><span class="o">.</span><span class="n">initdist</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">1</span><span class="o">/</span><span class="n">n</span><span class="p">]</span><span class="o">*</span><span class="n">n</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="HST">
<a class="anchor" href="#HST" aria-hidden="true"><span class="octicon octicon-link"></span></a>HST<a class="anchor-link" href="#HST"> </a>
</h3>
</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="o">%</span><span class="k">run</span> heavysnow 
<span class="n">hst</span><span class="o">=</span><span class="n">HeavySnowTransform</span><span class="p">(</span><span class="n">gs</span><span class="p">)</span>
<span class="n">hst</span><span class="o">.</span><span class="n">snow</span><span class="p">(</span><span class="n">tau</span><span class="o">=</span><span class="mi">80000</span><span class="p">,</span><span class="n">b</span><span class="o">=</span><span class="mf">0.015</span><span class="p">,</span><span class="n">maxflow</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>HST (tau= 80000, b=0.015)
80000/80000
HST completed and all history is recorded.
</pre>
</div>
</div>

</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">hst</span><span class="o">.</span><span class="n">snowdistance</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>&lt;matplotlib.image.AxesImage at 0x7f5bac1a0490&gt;</pre>
</div>

</div>

<div class="output_area">



<div class="output_png output_subarea ">
<img src="data:image/png;base64,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%0A">
</div>

</div>

</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">hst</span><span class="o">.</span><span class="n">snowweight</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">hst</span><span class="o">.</span><span class="n">snowdistance</span><span class="o">/</span><span class="p">(</span><span class="n">hst</span><span class="o">.</span><span class="n">tau</span><span class="o">*</span><span class="n">hst</span><span class="o">.</span><span class="n">b</span><span class="o">**</span><span class="mf">1.5</span><span class="p">))</span><span class="o">-</span><span class="n">np</span><span class="o">.</span><span class="n">eye</span><span class="p">(</span><span class="n">n</span><span class="p">,</span><span class="n">n</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">hst</span><span class="o">.</span><span class="n">snowweight</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>&lt;matplotlib.image.AxesImage at 0x7f5bab7ed970&gt;</pre>
</div>

</div>

<div class="output_area">



<div class="output_png output_subarea ">
<img src="data:image/png;base64,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%0A">
</div>

</div>

</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="시각화를-위해서-R로-자료를-옮김">
<a class="anchor" href="#%EC%8B%9C%EA%B0%81%ED%99%94%EB%A5%BC-%EC%9C%84%ED%95%B4%EC%84%9C-R%EB%A1%9C-%EC%9E%90%EB%A3%8C%EB%A5%BC-%EC%98%AE%EA%B9%80" aria-hidden="true"><span class="octicon octicon-link"></span></a>시각화를 위해서 R로 자료를 옮김<a class="anchor-link" href="#%EC%8B%9C%EA%B0%81%ED%99%94%EB%A5%BC-%EC%9C%84%ED%95%B4%EC%84%9C-R%EB%A1%9C-%EC%9E%90%EB%A3%8C%EB%A5%BC-%EC%98%AE%EA%B9%80"> </a>
</h3>
</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">maxtau</span><span class="o">=</span><span class="n">hst</span><span class="o">.</span><span class="n">tau</span>
<span class="n">W_Graph</span><span class="o">=</span><span class="n">hst</span><span class="o">.</span><span class="n">graphweight</span>
<span class="n">W_Euclid</span><span class="o">=</span><span class="n">hst</span><span class="o">.</span><span class="n">euclidweight</span>
<span class="n">W_HST</span><span class="o">=</span><span class="n">hst</span><span class="o">.</span><span class="n">snowweight</span>
<span class="n">V</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">hst</span><span class="o">.</span><span class="n">V</span><span class="p">)</span>
<span class="n">f</span><span class="o">=</span><span class="n">hst</span><span class="o">.</span><span class="n">f</span>
<span class="n">n</span><span class="o">=</span><span class="n">hst</span><span class="o">.</span><span class="n">n</span>
<span class="o">%</span><span class="k">R</span> -i maxtau,W_Graph,W_Euclid,W_HST,V,f,n
</pre></div>

    </div>
</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="R을-활용한-시각화-(1):-원래자료">
<a class="anchor" href="#R%EC%9D%84-%ED%99%9C%EC%9A%A9%ED%95%9C-%EC%8B%9C%EA%B0%81%ED%99%94-(1):-%EC%9B%90%EB%9E%98%EC%9E%90%EB%A3%8C" aria-hidden="true"><span class="octicon octicon-link"></span></a>R을 활용한 시각화 (1): 원래자료<a class="anchor-link" href="#R%EC%9D%84-%ED%99%9C%EC%9A%A9%ED%95%9C-%EC%8B%9C%EA%B0%81%ED%99%94-(1):-%EC%9B%90%EB%9E%98%EC%9E%90%EB%A3%8C"> </a>
</h3>
</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="o">%%</span><span class="n">R</span> <span class="o">-</span><span class="n">w</span> <span class="m">2000</span> <span class="o">-</span><span class="n">h</span> <span class="m">800</span> <span class="o">-</span><span class="n">r</span> <span class="m">100</span>
<span class="nf">library</span><span class="p">(</span><span class="n">tidyverse</span><span class="p">)</span>
<span class="nf">library</span><span class="p">(</span><span class="n">latex2exp</span><span class="p">)</span>
<span class="nf">library</span><span class="p">(</span><span class="n">gridExtra</span><span class="p">)</span>
<span class="nf">source</span><span class="p">(</span><span class="s">'rbase.R'</span><span class="p">)</span>
<span class="n">Vtext</span><span class="o">=</span><span class="nf">str_c</span><span class="p">(</span><span class="s">'node '</span><span class="p">,</span><span class="n">V</span><span class="m">+1</span><span class="p">)</span>
<span class="n">fig0</span><span class="o">&lt;-</span><span class="nf">ggplot</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="nf">tibble</span><span class="p">(</span><span class="n">V</span><span class="o">=</span><span class="n">V</span><span class="p">,</span><span class="n">f</span><span class="o">=</span><span class="n">f</span><span class="p">,</span><span class="n">Vtext</span><span class="o">=</span><span class="n">Vtext</span><span class="p">),</span><span class="nf">aes</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">V</span><span class="p">,</span><span class="n">y</span><span class="o">=</span><span class="n">f</span><span class="p">,</span><span class="n">label</span><span class="o">=</span><span class="n">Vtext</span><span class="p">))</span><span class="o">+</span>
<span class="nf">geom_col</span><span class="p">(</span><span class="nf">aes</span><span class="p">(</span><span class="n">fill</span><span class="o">=</span><span class="p">(</span><span class="n">f</span><span class="o">&gt;</span><span class="m">0</span><span class="p">)),</span><span class="n">width</span><span class="o">=</span><span class="m">0.1</span><span class="p">)</span><span class="o">+</span><span class="nf">geom_hline</span><span class="p">(</span><span class="nf">aes</span><span class="p">(</span><span class="n">yintercept</span><span class="o">=</span><span class="m">0</span><span class="p">),</span><span class="n">col</span><span class="o">=</span><span class="s">"gray60"</span><span class="p">,</span><span class="n">lty</span><span class="o">=</span><span class="m">2</span><span class="p">)</span><span class="o">+</span>
<span class="nf">geom_text</span><span class="p">(</span><span class="n">fontface</span> <span class="o">=</span> <span class="m">4</span><span class="p">,</span><span class="n">size</span><span class="o">=</span><span class="m">8</span><span class="p">)</span><span class="o">+</span>
<span class="nf">xlab</span><span class="p">(</span><span class="s">""</span><span class="p">)</span><span class="o">+</span><span class="nf">ylab</span><span class="p">(</span><span class="s">""</span><span class="p">)</span><span class="o">+</span><span class="nf">guides</span><span class="p">(</span><span class="n">fill</span><span class="o">=</span><span class="kc">FALSE</span><span class="p">)</span><span class="o">+</span><span class="nf">theme</span><span class="p">(</span><span class="n">plot.title</span><span class="o">=</span><span class="nf">element_text</span><span class="p">(</span><span class="n">face</span><span class="o">=</span><span class="s">"bold.italic"</span><span class="p">))</span><span class="o">+</span><span class="nf">theme_bw</span><span class="p">()</span><span class="o">+</span>
<span class="nf">theme</span><span class="p">(</span><span class="n">strip.text.x</span> <span class="o">=</span> <span class="nf">element_text</span><span class="p">(</span><span class="n">size</span> <span class="o">=</span> <span class="m">20</span><span class="p">,</span> <span class="n">color</span> <span class="o">=</span> <span class="s">"black"</span><span class="p">,</span> <span class="n">face</span> <span class="o">=</span> <span class="s">"bold.italic"</span><span class="p">))</span><span class="o">+</span>
<span class="nf">theme</span><span class="p">(</span><span class="n">strip.text.y</span> <span class="o">=</span> <span class="nf">element_text</span><span class="p">(</span><span class="n">size</span> <span class="o">=</span> <span class="m">15</span><span class="p">,</span> <span class="n">color</span> <span class="o">=</span> <span class="s">"black"</span><span class="p">,</span> <span class="n">face</span> <span class="o">=</span> <span class="s">"bold.italic"</span><span class="p">))</span><span class="o">+</span>
<span class="nf">ylim</span><span class="p">(</span><span class="m">-1.2</span><span class="p">,</span><span class="m">1.2</span><span class="p">)</span><span class="o">+</span>
<span class="nf">theme</span><span class="p">(</span><span class="n">plot.title</span><span class="o">=</span><span class="nf">element_text</span><span class="p">(</span><span class="n">face</span><span class="o">=</span><span class="s">"bold.italic"</span><span class="p">))</span>
<span class="c1">#ggsave(plot=p0,"./fig/2021-0217_fig0.pdf",width=20,height=6)</span>
<span class="n">fig0</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stderr output_text">
<pre>R[write to console]: ── Attaching packages ─────────────────────────────────────── tidyverse 1.3.1 ──

R[write to console]: ✔ ggplot2 3.3.5     ✔ purrr   0.3.4
✔ tibble  3.1.3     ✔ dplyr   1.0.7
✔ tidyr   1.1.3     ✔ stringr 1.4.0
✔ readr   1.4.0     ✔ forcats 0.5.1

R[write to console]: ── Conflicts ────────────────────────────────────────── tidyverse_conflicts() ──
✖ dplyr::filter() masks stats::filter()
✖ dplyr::lag()    masks stats::lag()

R[write to console]: Error in library(gridExtra) : there is no package called ‘gridExtra’

</pre>
</div>
</div>

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>
Error in library(gridExtra) : there is no package called ‘gridExtra’
</pre>
</div>
</div>

<div class="output_area">

<div class="output_subarea output_text output_error">
<pre>
<span class="ansi-red-fg">---------------------------------------------------------------------------</span>
<span class="ansi-red-fg">RRuntimeError</span>                             Traceback (most recent call last)
<span class="ansi-green-fg">~/anaconda3/envs/py38r40/lib/python3.8/site-packages/rpy2/ipython/rmagic.py</span> in <span class="ansi-cyan-fg">eval</span><span class="ansi-blue-fg">(self, code)</span>
<span class="ansi-green-intense-fg ansi-bold">    267</span>                 <span class="ansi-red-fg"># Need the newline in case the last line in code is a comment.</span>
<span class="ansi-green-fg">--&gt; 268</span><span class="ansi-red-fg">                 </span>value<span class="ansi-blue-fg">,</span> visible <span class="ansi-blue-fg">=</span> ro<span class="ansi-blue-fg">.</span>r<span class="ansi-blue-fg">(</span><span class="ansi-blue-fg">"withVisible({%s\n})"</span> <span class="ansi-blue-fg">%</span> code<span class="ansi-blue-fg">)</span>
<span class="ansi-green-intense-fg ansi-bold">    269</span>             <span class="ansi-green-fg">except</span> <span class="ansi-blue-fg">(</span>ri<span class="ansi-blue-fg">.</span>embedded<span class="ansi-blue-fg">.</span>RRuntimeError<span class="ansi-blue-fg">,</span> ValueError<span class="ansi-blue-fg">)</span> <span class="ansi-green-fg">as</span> exception<span class="ansi-blue-fg">:</span>

<span class="ansi-green-fg">~/anaconda3/envs/py38r40/lib/python3.8/site-packages/rpy2/robjects/__init__.py</span> in <span class="ansi-cyan-fg">__call__</span><span class="ansi-blue-fg">(self, string)</span>
<span class="ansi-green-intense-fg ansi-bold">    437</span>         p <span class="ansi-blue-fg">=</span> rinterface<span class="ansi-blue-fg">.</span>parse<span class="ansi-blue-fg">(</span>string<span class="ansi-blue-fg">)</span>
<span class="ansi-green-fg">--&gt; 438</span><span class="ansi-red-fg">         </span>res <span class="ansi-blue-fg">=</span> self<span class="ansi-blue-fg">.</span>eval<span class="ansi-blue-fg">(</span>p<span class="ansi-blue-fg">)</span>
<span class="ansi-green-intense-fg ansi-bold">    439</span>         <span class="ansi-green-fg">return</span> conversion<span class="ansi-blue-fg">.</span>rpy2py<span class="ansi-blue-fg">(</span>res<span class="ansi-blue-fg">)</span>

<span class="ansi-green-fg">~/anaconda3/envs/py38r40/lib/python3.8/site-packages/rpy2/robjects/functions.py</span> in <span class="ansi-cyan-fg">__call__</span><span class="ansi-blue-fg">(self, *args, **kwargs)</span>
<span class="ansi-green-intense-fg ansi-bold">    197</span>                 kwargs<span class="ansi-blue-fg">[</span>r_k<span class="ansi-blue-fg">]</span> <span class="ansi-blue-fg">=</span> v
<span class="ansi-green-fg">--&gt; 198</span><span class="ansi-red-fg">         return (super(SignatureTranslatedFunction, self)
</span><span class="ansi-green-intense-fg ansi-bold">    199</span>                 .__call__(*args, **kwargs))

<span class="ansi-green-fg">~/anaconda3/envs/py38r40/lib/python3.8/site-packages/rpy2/robjects/functions.py</span> in <span class="ansi-cyan-fg">__call__</span><span class="ansi-blue-fg">(self, *args, **kwargs)</span>
<span class="ansi-green-intense-fg ansi-bold">    124</span>                 new_kwargs<span class="ansi-blue-fg">[</span>k<span class="ansi-blue-fg">]</span> <span class="ansi-blue-fg">=</span> conversion<span class="ansi-blue-fg">.</span>py2rpy<span class="ansi-blue-fg">(</span>v<span class="ansi-blue-fg">)</span>
<span class="ansi-green-fg">--&gt; 125</span><span class="ansi-red-fg">         </span>res <span class="ansi-blue-fg">=</span> super<span class="ansi-blue-fg">(</span>Function<span class="ansi-blue-fg">,</span> self<span class="ansi-blue-fg">)</span><span class="ansi-blue-fg">.</span>__call__<span class="ansi-blue-fg">(</span><span class="ansi-blue-fg">*</span>new_args<span class="ansi-blue-fg">,</span> <span class="ansi-blue-fg">**</span>new_kwargs<span class="ansi-blue-fg">)</span>
<span class="ansi-green-intense-fg ansi-bold">    126</span>         res <span class="ansi-blue-fg">=</span> conversion<span class="ansi-blue-fg">.</span>rpy2py<span class="ansi-blue-fg">(</span>res<span class="ansi-blue-fg">)</span>

<span class="ansi-green-fg">~/anaconda3/envs/py38r40/lib/python3.8/site-packages/rpy2/rinterface_lib/conversion.py</span> in <span class="ansi-cyan-fg">_</span><span class="ansi-blue-fg">(*args, **kwargs)</span>
<span class="ansi-green-intense-fg ansi-bold">     44</span>     <span class="ansi-green-fg">def</span> _<span class="ansi-blue-fg">(</span><span class="ansi-blue-fg">*</span>args<span class="ansi-blue-fg">,</span> <span class="ansi-blue-fg">**</span>kwargs<span class="ansi-blue-fg">)</span><span class="ansi-blue-fg">:</span>
<span class="ansi-green-fg">---&gt; 45</span><span class="ansi-red-fg">         </span>cdata <span class="ansi-blue-fg">=</span> function<span class="ansi-blue-fg">(</span><span class="ansi-blue-fg">*</span>args<span class="ansi-blue-fg">,</span> <span class="ansi-blue-fg">**</span>kwargs<span class="ansi-blue-fg">)</span>
<span class="ansi-green-intense-fg ansi-bold">     46</span>         <span class="ansi-red-fg"># TODO: test cdata is of the expected CType</span>

<span class="ansi-green-fg">~/anaconda3/envs/py38r40/lib/python3.8/site-packages/rpy2/rinterface.py</span> in <span class="ansi-cyan-fg">__call__</span><span class="ansi-blue-fg">(self, *args, **kwargs)</span>
<span class="ansi-green-intense-fg ansi-bold">    679</span>             <span class="ansi-green-fg">if</span> error_occured<span class="ansi-blue-fg">[</span><span class="ansi-cyan-fg">0</span><span class="ansi-blue-fg">]</span><span class="ansi-blue-fg">:</span>
<span class="ansi-green-fg">--&gt; 680</span><span class="ansi-red-fg">                 </span><span class="ansi-green-fg">raise</span> embedded<span class="ansi-blue-fg">.</span>RRuntimeError<span class="ansi-blue-fg">(</span>_rinterface<span class="ansi-blue-fg">.</span>_geterrmessage<span class="ansi-blue-fg">(</span><span class="ansi-blue-fg">)</span><span class="ansi-blue-fg">)</span>
<span class="ansi-green-intense-fg ansi-bold">    681</span>         <span class="ansi-green-fg">return</span> res

<span class="ansi-red-fg">RRuntimeError</span>: Error in library(gridExtra) : there is no package called ‘gridExtra’


During handling of the above exception, another exception occurred:

<span class="ansi-red-fg">RInterpreterError</span>                         Traceback (most recent call last)
<span class="ansi-green-fg">/tmp/ipykernel_37481/2086553443.py</span> in <span class="ansi-cyan-fg">&lt;module&gt;</span>
<span class="ansi-green-fg">----&gt; 1</span><span class="ansi-red-fg"> </span>get_ipython<span class="ansi-blue-fg">(</span><span class="ansi-blue-fg">)</span><span class="ansi-blue-fg">.</span>run_cell_magic<span class="ansi-blue-fg">(</span><span class="ansi-blue-fg">'R'</span><span class="ansi-blue-fg">,</span> <span class="ansi-blue-fg">'-w 2000 -h 800 -r 100'</span><span class="ansi-blue-fg">,</span> <span class="ansi-blue-fg">'library(tidyverse)\nlibrary(latex2exp)\nlibrary(gridExtra)\nsource(\'rbase.R\')\nVtext=str_c(\'node \',V+1)\nfig0&lt;-ggplot(data=tibble(V=V,f=f,Vtext=Vtext),aes(x=V,y=f,label=Vtext))+\ngeom_col(aes(fill=(f&gt;0)),width=0.1)+geom_hline(aes(yintercept=0),col="gray60",lty=2)+\ngeom_text(fontface = 4,size=8)+\nxlab("")+ylab("")+guides(fill=FALSE)+theme(plot.title=element_text(face="bold.italic"))+theme_bw()+\ntheme(strip.text.x = element_text(size = 20, color = "black", face = "bold.italic"))+\ntheme(strip.text.y = element_text(size = 15, color = "black", face = "bold.italic"))+\nylim(-1.2,1.2)+\ntheme(plot.title=element_text(face="bold.italic"))\n#ggsave(plot=p0,"./fig/2021-0217_fig0.pdf",width=20,height=6)\nfig0\n'</span><span class="ansi-blue-fg">)</span>

<span class="ansi-green-fg">~/anaconda3/envs/py38r40/lib/python3.8/site-packages/IPython/core/interactiveshell.py</span> in <span class="ansi-cyan-fg">run_cell_magic</span><span class="ansi-blue-fg">(self, magic_name, line, cell)</span>
<span class="ansi-green-intense-fg ansi-bold">   2401</span>             <span class="ansi-green-fg">with</span> self<span class="ansi-blue-fg">.</span>builtin_trap<span class="ansi-blue-fg">:</span>
<span class="ansi-green-intense-fg ansi-bold">   2402</span>                 args <span class="ansi-blue-fg">=</span> <span class="ansi-blue-fg">(</span>magic_arg_s<span class="ansi-blue-fg">,</span> cell<span class="ansi-blue-fg">)</span>
<span class="ansi-green-fg">-&gt; 2403</span><span class="ansi-red-fg">                 </span>result <span class="ansi-blue-fg">=</span> fn<span class="ansi-blue-fg">(</span><span class="ansi-blue-fg">*</span>args<span class="ansi-blue-fg">,</span> <span class="ansi-blue-fg">**</span>kwargs<span class="ansi-blue-fg">)</span>
<span class="ansi-green-intense-fg ansi-bold">   2404</span>             <span class="ansi-green-fg">return</span> result
<span class="ansi-green-intense-fg ansi-bold">   2405</span> 

<span class="ansi-green-fg">~/anaconda3/envs/py38r40/lib/python3.8/site-packages/decorator.py</span> in <span class="ansi-cyan-fg">fun</span><span class="ansi-blue-fg">(*args, **kw)</span>
<span class="ansi-green-intense-fg ansi-bold">    230</span>             <span class="ansi-green-fg">if</span> <span class="ansi-green-fg">not</span> kwsyntax<span class="ansi-blue-fg">:</span>
<span class="ansi-green-intense-fg ansi-bold">    231</span>                 args<span class="ansi-blue-fg">,</span> kw <span class="ansi-blue-fg">=</span> fix<span class="ansi-blue-fg">(</span>args<span class="ansi-blue-fg">,</span> kw<span class="ansi-blue-fg">,</span> sig<span class="ansi-blue-fg">)</span>
<span class="ansi-green-fg">--&gt; 232</span><span class="ansi-red-fg">             </span><span class="ansi-green-fg">return</span> caller<span class="ansi-blue-fg">(</span>func<span class="ansi-blue-fg">,</span> <span class="ansi-blue-fg">*</span><span class="ansi-blue-fg">(</span>extras <span class="ansi-blue-fg">+</span> args<span class="ansi-blue-fg">)</span><span class="ansi-blue-fg">,</span> <span class="ansi-blue-fg">**</span>kw<span class="ansi-blue-fg">)</span>
<span class="ansi-green-intense-fg ansi-bold">    233</span>     fun<span class="ansi-blue-fg">.</span>__name__ <span class="ansi-blue-fg">=</span> func<span class="ansi-blue-fg">.</span>__name__
<span class="ansi-green-intense-fg ansi-bold">    234</span>     fun<span class="ansi-blue-fg">.</span>__doc__ <span class="ansi-blue-fg">=</span> func<span class="ansi-blue-fg">.</span>__doc__

<span class="ansi-green-fg">~/anaconda3/envs/py38r40/lib/python3.8/site-packages/IPython/core/magic.py</span> in <span class="ansi-cyan-fg">&lt;lambda&gt;</span><span class="ansi-blue-fg">(f, *a, **k)</span>
<span class="ansi-green-intense-fg ansi-bold">    185</span>     <span class="ansi-red-fg"># but it's overkill for just that one bit of state.</span>
<span class="ansi-green-intense-fg ansi-bold">    186</span>     <span class="ansi-green-fg">def</span> magic_deco<span class="ansi-blue-fg">(</span>arg<span class="ansi-blue-fg">)</span><span class="ansi-blue-fg">:</span>
<span class="ansi-green-fg">--&gt; 187</span><span class="ansi-red-fg">         </span>call <span class="ansi-blue-fg">=</span> <span class="ansi-green-fg">lambda</span> f<span class="ansi-blue-fg">,</span> <span class="ansi-blue-fg">*</span>a<span class="ansi-blue-fg">,</span> <span class="ansi-blue-fg">**</span>k<span class="ansi-blue-fg">:</span> f<span class="ansi-blue-fg">(</span><span class="ansi-blue-fg">*</span>a<span class="ansi-blue-fg">,</span> <span class="ansi-blue-fg">**</span>k<span class="ansi-blue-fg">)</span>
<span class="ansi-green-intense-fg ansi-bold">    188</span> 
<span class="ansi-green-intense-fg ansi-bold">    189</span>         <span class="ansi-green-fg">if</span> callable<span class="ansi-blue-fg">(</span>arg<span class="ansi-blue-fg">)</span><span class="ansi-blue-fg">:</span>

<span class="ansi-green-fg">~/anaconda3/envs/py38r40/lib/python3.8/site-packages/rpy2/ipython/rmagic.py</span> in <span class="ansi-cyan-fg">R</span><span class="ansi-blue-fg">(self, line, cell, local_ns)</span>
<span class="ansi-green-intense-fg ansi-bold">    781</span>             <span class="ansi-green-fg">if</span> <span class="ansi-green-fg">not</span> e<span class="ansi-blue-fg">.</span>stdout<span class="ansi-blue-fg">.</span>endswith<span class="ansi-blue-fg">(</span>e<span class="ansi-blue-fg">.</span>err<span class="ansi-blue-fg">)</span><span class="ansi-blue-fg">:</span>
<span class="ansi-green-intense-fg ansi-bold">    782</span>                 print<span class="ansi-blue-fg">(</span>e<span class="ansi-blue-fg">.</span>err<span class="ansi-blue-fg">)</span>
<span class="ansi-green-fg">--&gt; 783</span><span class="ansi-red-fg">             </span><span class="ansi-green-fg">raise</span> e
<span class="ansi-green-intense-fg ansi-bold">    784</span>         <span class="ansi-green-fg">finally</span><span class="ansi-blue-fg">:</span>
<span class="ansi-green-intense-fg ansi-bold">    785</span>             <span class="ansi-green-fg">if</span> self<span class="ansi-blue-fg">.</span>device <span class="ansi-green-fg">in</span> <span class="ansi-blue-fg">[</span><span class="ansi-blue-fg">'png'</span><span class="ansi-blue-fg">,</span> <span class="ansi-blue-fg">'svg'</span><span class="ansi-blue-fg">]</span><span class="ansi-blue-fg">:</span>

<span class="ansi-green-fg">~/anaconda3/envs/py38r40/lib/python3.8/site-packages/rpy2/ipython/rmagic.py</span> in <span class="ansi-cyan-fg">R</span><span class="ansi-blue-fg">(self, line, cell, local_ns)</span>
<span class="ansi-green-intense-fg ansi-bold">    761</span>                     return_output <span class="ansi-blue-fg">=</span> <span class="ansi-green-fg">False</span>
<span class="ansi-green-intense-fg ansi-bold">    762</span>             <span class="ansi-green-fg">else</span><span class="ansi-blue-fg">:</span>
<span class="ansi-green-fg">--&gt; 763</span><span class="ansi-red-fg">                 </span>text_result<span class="ansi-blue-fg">,</span> result<span class="ansi-blue-fg">,</span> visible <span class="ansi-blue-fg">=</span> self<span class="ansi-blue-fg">.</span>eval<span class="ansi-blue-fg">(</span>code<span class="ansi-blue-fg">)</span>
<span class="ansi-green-intense-fg ansi-bold">    764</span>                 text_output <span class="ansi-blue-fg">+=</span> text_result
<span class="ansi-green-intense-fg ansi-bold">    765</span>                 <span class="ansi-green-fg">if</span> visible<span class="ansi-blue-fg">:</span>

<span class="ansi-green-fg">~/anaconda3/envs/py38r40/lib/python3.8/site-packages/rpy2/ipython/rmagic.py</span> in <span class="ansi-cyan-fg">eval</span><span class="ansi-blue-fg">(self, code)</span>
<span class="ansi-green-intense-fg ansi-bold">    270</span>                 <span class="ansi-red-fg"># Otherwise next return seems to have copy of error.</span>
<span class="ansi-green-intense-fg ansi-bold">    271</span>                 warning_or_other_msg <span class="ansi-blue-fg">=</span> self<span class="ansi-blue-fg">.</span>flush<span class="ansi-blue-fg">(</span><span class="ansi-blue-fg">)</span>
<span class="ansi-green-fg">--&gt; 272</span><span class="ansi-red-fg">                 raise RInterpreterError(code, str(exception),
</span><span class="ansi-green-intense-fg ansi-bold">    273</span>                                         warning_or_other_msg)
<span class="ansi-green-intense-fg ansi-bold">    274</span>             text_output <span class="ansi-blue-fg">=</span> self<span class="ansi-blue-fg">.</span>flush<span class="ansi-blue-fg">(</span><span class="ansi-blue-fg">)</span>

<span class="ansi-red-fg">RInterpreterError</span>: Failed to parse and evaluate line 'library(tidyverse)\nlibrary(latex2exp)\nlibrary(gridExtra)\nsource(\'rbase.R\')\nVtext=str_c(\'node \',V+1)\nfig0&lt;-ggplot(data=tibble(V=V,f=f,Vtext=Vtext),aes(x=V,y=f,label=Vtext))+\ngeom_col(aes(fill=(f&gt;0)),width=0.1)+geom_hline(aes(yintercept=0),col="gray60",lty=2)+\ngeom_text(fontface = 4,size=8)+\nxlab("")+ylab("")+guides(fill=FALSE)+theme(plot.title=element_text(face="bold.italic"))+theme_bw()+\ntheme(strip.text.x = element_text(size = 20, color = "black", face = "bold.italic"))+\ntheme(strip.text.y = element_text(size = 15, color = "black", face = "bold.italic"))+\nylim(-1.2,1.2)+\ntheme(plot.title=element_text(face="bold.italic"))\n#ggsave(plot=p0,"./fig/2021-0217_fig0.pdf",width=20,height=6)\nfig0\n'.
R error message: 'Error in library(gridExtra) : there is no package called ‘gridExtra’'</pre>
</div>
</div>

</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="R을-활용한-시각화-(2):-Weight-matrix-와-Eigen-plot">
<a class="anchor" href="#R%EC%9D%84-%ED%99%9C%EC%9A%A9%ED%95%9C-%EC%8B%9C%EA%B0%81%ED%99%94-(2):-Weight-matrix-%EC%99%80-Eigen-plot" aria-hidden="true"><span class="octicon octicon-link"></span></a>R을 활용한 시각화 (2): Weight matrix 와 Eigen plot<a class="anchor-link" href="#R%EC%9D%84-%ED%99%9C%EC%9A%A9%ED%95%9C-%EC%8B%9C%EA%B0%81%ED%99%94-(2):-Weight-matrix-%EC%99%80-Eigen-plot"> </a>
</h3>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><code>-</code> <code>ggplot</code>에서 <code>geom_tile</code>을 사용하기 위해서 매트릭스 형태인 <code>W_Graph</code>, <code>W_Euclid</code>, <code>W_HST</code>를 길게 펼친다. 결과를 각각 <code>W_Graph_long</code>, <code>W_Euclid_long</code>, <code>W_HST_long</code>에 저장한다.</p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="o">%%</span><span class="n">R</span>
<span class="n">grid</span><span class="o">&lt;-</span><span class="nf">expand.grid</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="m">1</span><span class="o">:</span><span class="n">n</span><span class="p">,</span><span class="n">y</span><span class="o">=</span><span class="m">1</span><span class="o">:</span><span class="n">n</span><span class="p">)</span>
<span class="n">W_Graph_long</span><span class="o">&lt;-</span><span class="nf">as_tibble</span><span class="p">(</span><span class="nf">cbind</span><span class="p">(</span><span class="n">grid</span><span class="p">,</span><span class="nf">as.vector</span><span class="p">(</span><span class="n">W_Graph</span><span class="p">)));</span><span class="nf">names</span><span class="p">(</span><span class="n">W_Graph_long</span><span class="p">)</span><span class="o">&lt;-</span><span class="nf">c</span><span class="p">(</span><span class="s">"x"</span><span class="p">,</span><span class="s">"y"</span><span class="p">,</span><span class="s">"W"</span><span class="p">)</span>
<span class="n">W_Euclid_long</span><span class="o">&lt;-</span><span class="nf">as_tibble</span><span class="p">(</span><span class="nf">cbind</span><span class="p">(</span><span class="n">grid</span><span class="p">,</span><span class="nf">as.vector</span><span class="p">(</span><span class="n">W_Euclid</span><span class="p">)));</span><span class="nf">names</span><span class="p">(</span><span class="n">W_Euclid_long</span><span class="p">)</span><span class="o">&lt;-</span><span class="nf">c</span><span class="p">(</span><span class="s">"x"</span><span class="p">,</span><span class="s">"y"</span><span class="p">,</span><span class="s">"W"</span><span class="p">)</span>
<span class="n">W_HST_long</span><span class="o">&lt;-</span><span class="nf">as_tibble</span><span class="p">(</span><span class="nf">cbind</span><span class="p">(</span><span class="n">grid</span><span class="p">,</span><span class="nf">as.vector</span><span class="p">(</span><span class="n">W_HST</span><span class="p">)));</span><span class="nf">names</span><span class="p">(</span><span class="n">W_HST_long</span><span class="p">)</span><span class="o">&lt;-</span><span class="nf">c</span><span class="p">(</span><span class="s">"x"</span><span class="p">,</span><span class="s">"y"</span><span class="p">,</span><span class="s">"W"</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><code>-</code> 그래프퓨리에 변환: $(\bf{f},\bf{W})$에 그래프 퓨리에 변환을 수행함.</p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="o">%%</span><span class="n">R</span>
<span class="nf">source</span><span class="p">(</span><span class="s">'heavysnow.R'</span><span class="p">)</span>
<span class="n">gfftrslt_Euclid</span><span class="o">&lt;-</span><span class="nf">gfft</span><span class="p">(</span><span class="n">f</span><span class="p">,</span><span class="n">W_Euclid</span><span class="p">)</span>
<span class="n">gfftrslt_Graph</span><span class="o">&lt;-</span><span class="nf">gfft</span><span class="p">(</span><span class="n">f</span><span class="p">,</span><span class="n">W_Graph</span><span class="p">)</span>
<span class="n">gfftrslt_HST</span><span class="o">&lt;-</span><span class="nf">gfft</span><span class="p">(</span><span class="n">f</span><span class="p">,</span><span class="n">W_HST</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><code>-</code> 그래프 퓨리에 변환의 결과 고유치, 고유벡터, $\bf{\bar{f}}$가 반환됨.</p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="o">%%</span><span class="n">R</span>
<span class="nf">head</span><span class="p">(</span><span class="n">gfftrslt_HST</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><code>-</code> 시각화코드</p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="o">%%</span><span class="n">R</span> <span class="o">-</span><span class="n">w</span> <span class="m">1000</span> <span class="o">-</span><span class="n">h</span> <span class="m">800</span> <span class="o">-</span><span class="n">r</span> <span class="m">100</span>
<span class="nf">library</span><span class="p">(</span><span class="n">gridExtra</span><span class="p">)</span>

<span class="n">fig1_1</span><span class="o">&lt;-</span><span class="nf">ggplot</span><span class="p">()</span><span class="o">+</span><span class="nf">geom_tile</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">W_Euclid_long</span><span class="p">,</span><span class="nf">aes</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="o">=</span><span class="n">y</span><span class="p">,</span><span class="n">fill</span><span class="o">=</span><span class="n">W</span><span class="p">))</span><span class="o">+</span><span class="nf">theme_bw</span><span class="p">()</span><span class="o">+</span><span class="nf">xlab</span><span class="p">(</span><span class="s">""</span><span class="p">)</span><span class="o">+</span><span class="nf">ylab</span><span class="p">(</span><span class="s">""</span><span class="p">)</span><span class="o">+</span>
<span class="nf">theme</span><span class="p">(</span><span class="n">strip.text.x</span> <span class="o">=</span> <span class="nf">element_text</span><span class="p">(</span><span class="n">size</span> <span class="o">=</span> <span class="m">20</span><span class="p">,</span> <span class="n">color</span> <span class="o">=</span> <span class="s">"black"</span><span class="p">,</span> <span class="n">face</span> <span class="o">=</span> <span class="s">"bold.italic"</span><span class="p">))</span><span class="o">+</span>
<span class="nf">theme</span><span class="p">(</span><span class="n">strip.text.y</span> <span class="o">=</span> <span class="nf">element_text</span><span class="p">(</span><span class="n">size</span> <span class="o">=</span> <span class="m">20</span><span class="p">,</span> <span class="n">color</span> <span class="o">=</span> <span class="s">"black"</span><span class="p">,</span> <span class="n">face</span> <span class="o">=</span> <span class="s">"bold.italic"</span><span class="p">))</span><span class="o">+</span>
<span class="nf">scale_fill_gradient2</span><span class="p">(</span><span class="n">low</span><span class="o">=</span><span class="s">"red"</span><span class="p">,</span><span class="n">high</span><span class="o">=</span><span class="s">"blue"</span><span class="p">,</span><span class="n">mid</span><span class="o">=</span><span class="s">"purple"</span><span class="p">,</span><span class="n">midpoint</span><span class="o">=</span><span class="m">0.25</span><span class="p">,</span><span class="n">breaks</span><span class="o">=</span><span class="nf">c</span><span class="p">(</span><span class="m">0</span><span class="p">,</span><span class="m">0.5</span><span class="p">,</span><span class="m">0.99</span><span class="p">))</span><span class="o">+</span>
<span class="nf">labs</span><span class="p">(</span><span class="n">fill</span><span class="o">=</span><span class="nf">TeX</span><span class="p">(</span><span class="s">'$W$'</span><span class="p">))</span><span class="o">+</span>
<span class="nf">theme</span><span class="p">(</span><span class="n">legend.position</span><span class="o">=</span><span class="s">"none"</span><span class="p">)</span><span class="o">+</span><span class="nf">theme</span><span class="p">(</span><span class="n">legend.key</span><span class="o">=</span><span class="nf">element_blank</span><span class="p">())</span><span class="o">+</span>
<span class="nf">ggtitle</span><span class="p">(</span><span class="s">"(a) Euclid"</span><span class="p">)</span><span class="o">+</span><span class="nf">theme</span><span class="p">(</span><span class="n">plot.title</span><span class="o">=</span><span class="nf">element_text</span><span class="p">(</span><span class="n">face</span><span class="o">=</span><span class="s">"bold.italic"</span><span class="p">,</span><span class="n">size</span><span class="o">=</span><span class="nf">rel</span><span class="p">(</span><span class="m">3</span><span class="p">)))</span>

<span class="n">fig1_2</span><span class="o">&lt;-</span><span class="nf">ggplot</span><span class="p">()</span><span class="o">+</span><span class="nf">geom_tile</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">W_Graph_long</span><span class="p">,</span><span class="nf">aes</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="o">=</span><span class="n">y</span><span class="p">,</span><span class="n">fill</span><span class="o">=</span><span class="n">W</span><span class="p">))</span><span class="o">+</span><span class="nf">theme_bw</span><span class="p">()</span><span class="o">+</span><span class="nf">xlab</span><span class="p">(</span><span class="s">""</span><span class="p">)</span><span class="o">+</span><span class="nf">ylab</span><span class="p">(</span><span class="s">""</span><span class="p">)</span><span class="o">+</span>
<span class="nf">theme</span><span class="p">(</span><span class="n">strip.text.x</span> <span class="o">=</span> <span class="nf">element_text</span><span class="p">(</span><span class="n">size</span> <span class="o">=</span> <span class="m">20</span><span class="p">,</span> <span class="n">color</span> <span class="o">=</span> <span class="s">"black"</span><span class="p">,</span> <span class="n">face</span> <span class="o">=</span> <span class="s">"bold.italic"</span><span class="p">))</span><span class="o">+</span>
<span class="nf">theme</span><span class="p">(</span><span class="n">strip.text.y</span> <span class="o">=</span> <span class="nf">element_text</span><span class="p">(</span><span class="n">size</span> <span class="o">=</span> <span class="m">20</span><span class="p">,</span> <span class="n">color</span> <span class="o">=</span> <span class="s">"black"</span><span class="p">,</span> <span class="n">face</span> <span class="o">=</span> <span class="s">"bold.italic"</span><span class="p">))</span><span class="o">+</span>
<span class="nf">scale_fill_gradient2</span><span class="p">(</span><span class="n">low</span><span class="o">=</span><span class="s">"red"</span><span class="p">,</span><span class="n">high</span><span class="o">=</span><span class="s">"blue"</span><span class="p">,</span><span class="n">mid</span><span class="o">=</span><span class="s">"purple"</span><span class="p">,</span><span class="n">midpoint</span><span class="o">=</span><span class="m">0.5</span><span class="p">,</span><span class="n">breaks</span><span class="o">=</span><span class="nf">c</span><span class="p">(</span><span class="m">0</span><span class="p">,</span><span class="m">0.5</span><span class="p">,</span><span class="m">0.99</span><span class="p">))</span><span class="o">+</span>
<span class="nf">labs</span><span class="p">(</span><span class="n">fill</span><span class="o">=</span><span class="nf">TeX</span><span class="p">(</span><span class="s">'$\\hat{W}$'</span><span class="p">))</span><span class="o">+</span>
<span class="nf">theme</span><span class="p">(</span><span class="n">legend.position</span><span class="o">=</span><span class="s">"none"</span><span class="p">)</span><span class="o">+</span><span class="nf">theme</span><span class="p">(</span><span class="n">legend.key</span><span class="o">=</span><span class="nf">element_blank</span><span class="p">())</span><span class="o">+</span>
<span class="nf">ggtitle</span><span class="p">(</span><span class="s">"(b) Graph"</span><span class="p">)</span><span class="o">+</span><span class="nf">theme</span><span class="p">(</span><span class="n">plot.title</span><span class="o">=</span><span class="nf">element_text</span><span class="p">(</span><span class="n">face</span><span class="o">=</span><span class="s">"bold.italic"</span><span class="p">,</span><span class="n">size</span><span class="o">=</span><span class="nf">rel</span><span class="p">(</span><span class="m">3</span><span class="p">)))</span>

<span class="n">fig1_3</span><span class="o">&lt;-</span><span class="nf">ggplot</span><span class="p">()</span><span class="o">+</span><span class="nf">geom_tile</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">W_HST_long</span><span class="p">,</span><span class="nf">aes</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="o">=</span><span class="n">y</span><span class="p">,</span><span class="n">fill</span><span class="o">=</span><span class="n">W</span><span class="p">))</span><span class="o">+</span><span class="nf">theme_bw</span><span class="p">()</span><span class="o">+</span><span class="nf">xlab</span><span class="p">(</span><span class="s">""</span><span class="p">)</span><span class="o">+</span><span class="nf">ylab</span><span class="p">(</span><span class="s">""</span><span class="p">)</span><span class="o">+</span>
<span class="nf">theme</span><span class="p">(</span><span class="n">strip.text.x</span> <span class="o">=</span> <span class="nf">element_text</span><span class="p">(</span><span class="n">size</span> <span class="o">=</span> <span class="m">20</span><span class="p">,</span> <span class="n">color</span> <span class="o">=</span> <span class="s">"black"</span><span class="p">,</span> <span class="n">face</span> <span class="o">=</span> <span class="s">"bold.italic"</span><span class="p">))</span><span class="o">+</span>
<span class="nf">theme</span><span class="p">(</span><span class="n">strip.text.y</span> <span class="o">=</span> <span class="nf">element_text</span><span class="p">(</span><span class="n">size</span> <span class="o">=</span> <span class="m">20</span><span class="p">,</span> <span class="n">color</span> <span class="o">=</span> <span class="s">"black"</span><span class="p">,</span> <span class="n">face</span> <span class="o">=</span> <span class="s">"bold.italic"</span><span class="p">))</span><span class="o">+</span>
<span class="nf">scale_fill_gradient2</span><span class="p">(</span><span class="n">low</span><span class="o">=</span><span class="s">"red"</span><span class="p">,</span><span class="n">high</span><span class="o">=</span><span class="s">"blue"</span><span class="p">,</span><span class="n">mid</span><span class="o">=</span><span class="s">"purple"</span><span class="p">,</span><span class="n">midpoint</span><span class="o">=</span><span class="m">0.5</span><span class="p">,</span><span class="n">breaks</span><span class="o">=</span><span class="nf">c</span><span class="p">(</span><span class="m">0</span><span class="p">,</span><span class="m">0.5</span><span class="p">,</span><span class="m">0.99</span><span class="p">))</span><span class="o">+</span>
<span class="nf">labs</span><span class="p">(</span><span class="n">fill</span><span class="o">=</span><span class="nf">TeX</span><span class="p">(</span><span class="s">'$\\hat{W}(\\tau)$'</span><span class="p">))</span><span class="o">+</span>
<span class="nf">theme</span><span class="p">(</span><span class="n">legend.position</span><span class="o">=</span><span class="s">"none"</span><span class="p">)</span><span class="o">+</span><span class="nf">theme</span><span class="p">(</span><span class="n">legend.key</span><span class="o">=</span><span class="nf">element_blank</span><span class="p">())</span><span class="o">+</span>
<span class="nf">ggtitle</span><span class="p">(</span><span class="s">"(c) HST"</span><span class="p">)</span><span class="o">+</span><span class="nf">theme</span><span class="p">(</span><span class="n">plot.title</span><span class="o">=</span><span class="nf">element_text</span><span class="p">(</span><span class="n">face</span><span class="o">=</span><span class="s">"bold.italic"</span><span class="p">,</span><span class="n">size</span><span class="o">=</span><span class="nf">rel</span><span class="p">(</span><span class="m">3</span><span class="p">)))</span>

<span class="n">fig1_4</span><span class="o">&lt;-</span><span class="nf">eigenplot</span><span class="p">(</span><span class="n">gfftrslt_Euclid</span><span class="p">)</span><span class="o">+</span><span class="nf">ylim</span><span class="p">(</span><span class="m">0</span><span class="p">,</span><span class="m">2</span><span class="p">)</span><span class="o">+</span><span class="nf">theme_light</span><span class="p">()</span>
<span class="n">fig1_5</span><span class="o">&lt;-</span><span class="nf">eigenplot</span><span class="p">(</span><span class="n">gfftrslt_Graph</span><span class="p">)</span><span class="o">+</span><span class="nf">ylim</span><span class="p">(</span><span class="m">0</span><span class="p">,</span><span class="m">2</span><span class="p">)</span><span class="o">+</span><span class="nf">theme_light</span><span class="p">()</span>
<span class="n">fig1_6</span><span class="o">&lt;-</span><span class="nf">eigenplot</span><span class="p">(</span><span class="n">gfftrslt_HST</span><span class="p">)</span><span class="o">+</span><span class="nf">ylim</span><span class="p">(</span><span class="m">0</span><span class="p">,</span><span class="m">2</span><span class="p">)</span><span class="o">+</span><span class="nf">theme_light</span><span class="p">()</span>
<span class="n">fig1</span><span class="o">=</span><span class="nf">grid.arrange</span><span class="p">(</span><span class="n">fig1_1</span><span class="p">,</span><span class="n">fig1_2</span><span class="p">,</span><span class="n">fig1_3</span><span class="p">,</span><span class="n">fig1_4</span><span class="p">,</span><span class="n">fig1_5</span><span class="p">,</span><span class="n">fig1_6</span><span class="p">,</span><span class="n">ncol</span><span class="o">=</span><span class="m">3</span><span class="p">,</span><span class="n">nrow</span><span class="o">=</span><span class="m">2</span><span class="p">)</span>
<span class="n">fig1</span>
<span class="c1">#ggsave(plot=grid.arrange(p1_a,p1_b,p1_c,ncol=3),"2021-07-22_fig1.png",width=20,height=4)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="R을-활용한-시각화-(3):-Decomposition">
<a class="anchor" href="#R%EC%9D%84-%ED%99%9C%EC%9A%A9%ED%95%9C-%EC%8B%9C%EA%B0%81%ED%99%94-(3):-Decomposition" aria-hidden="true"><span class="octicon octicon-link"></span></a>R을 활용한 시각화 (3): Decomposition<a class="anchor-link" href="#R%EC%9D%84-%ED%99%9C%EC%9A%A9%ED%95%9C-%EC%8B%9C%EA%B0%81%ED%99%94-(3):-Decomposition"> </a>
</h3>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><code>-</code> 디콤포지션을 수행하고 결과를 저장: $(\bf{f},\bf{W})$에 decomposition을 수행하고 그 결과를 각각 <code>decomprslt_Euclid</code>, <code>decomprslt_Graph</code>, <code>decomprslt_HST</code>에 저장한다.</p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="o">%%</span><span class="n">R</span> 
<span class="n">decomprslt_Euclid</span><span class="o">&lt;-</span><span class="nf">decompose</span><span class="p">(</span><span class="n">f</span><span class="p">,</span><span class="n">W_Euclid</span><span class="p">,</span><span class="n">V</span><span class="o">=</span><span class="m">1</span><span class="o">:</span><span class="n">n</span><span class="p">)</span> <span class="c1"># 0, 35000, 60000, 80000</span>
<span class="n">decomprslt_Graph</span><span class="o">&lt;-</span><span class="nf">decompose</span><span class="p">(</span><span class="n">f</span><span class="p">,</span><span class="n">W_Graph</span><span class="p">,</span><span class="n">V</span><span class="o">=</span><span class="m">1</span><span class="o">:</span><span class="n">n</span><span class="p">)</span> <span class="c1"># 0, 35000, 60000, 80000</span>
<span class="n">decomprslt_HST</span><span class="o">&lt;-</span><span class="nf">decompose</span><span class="p">(</span><span class="n">f</span><span class="p">,</span><span class="n">W_HST</span><span class="p">,</span><span class="n">V</span><span class="o">=</span><span class="m">1</span><span class="o">:</span><span class="n">n</span><span class="p">)</span> <span class="c1"># 0, 35000, 60000, 80000</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><code>-</code> 디콤포지션 결과는 아래와 같은 형태임</p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="o">%%</span><span class="n">R</span>
<span class="nf">head</span><span class="p">(</span><span class="n">decomprslt_Euclid</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="o">%%</span><span class="n">R</span> 
<span class="n">decomprslt_Euclid</span><span class="o">$</span><span class="n">method</span><span class="o">=</span><span class="s">"Euclid"</span>
<span class="n">decomprslt_Graph</span><span class="o">$</span><span class="n">method</span><span class="o">=</span><span class="s">"Graph"</span>
<span class="n">decomprslt_HST</span><span class="o">$</span><span class="n">method</span><span class="o">=</span><span class="s">"HST"</span>
<span class="n">decomprslt</span><span class="o">&lt;-</span><span class="nf">rbind</span><span class="p">(</span><span class="n">decomprslt_Euclid</span><span class="p">,</span><span class="n">decomprslt_Graph</span><span class="p">,</span><span class="n">decomprslt_HST</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><code>-</code> 디콤포지션결과를 시각화한다. <code>geom_col</code>과 <code>facet_grid</code>를 이용.</p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="o">%%</span><span class="n">R</span> <span class="o">-</span><span class="n">w</span> <span class="m">2000</span> <span class="o">-</span><span class="n">h</span> <span class="m">500</span> <span class="o">-</span><span class="n">r</span> <span class="m">100</span>
<span class="n">fig2</span><span class="o">&lt;-</span><span class="nf">ggplot</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">decomprslt</span><span class="p">,</span><span class="nf">aes</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">V</span><span class="p">,</span><span class="n">y</span><span class="o">=</span><span class="n">fhat</span><span class="p">))</span><span class="o">+</span>
<span class="nf">geom_col</span><span class="p">(</span><span class="nf">aes</span><span class="p">(</span><span class="n">fill</span><span class="o">=</span><span class="n">fhat</span><span class="o">&gt;</span><span class="m">0</span><span class="p">),</span><span class="n">width</span><span class="o">=</span><span class="m">0.7</span><span class="p">)</span><span class="o">+</span><span class="nf">facet_grid</span><span class="p">(</span><span class="n">method</span><span class="o">~</span><span class="n">eigenvectorindex</span><span class="p">)</span><span class="o">+</span><span class="nf">geom_hline</span><span class="p">(</span><span class="nf">aes</span><span class="p">(</span><span class="n">yintercept</span><span class="o">=</span><span class="m">0</span><span class="p">),</span><span class="n">col</span><span class="o">=</span><span class="s">"gray60"</span><span class="p">,</span><span class="n">lty</span><span class="o">=</span><span class="m">2</span><span class="p">)</span><span class="o">+</span>
<span class="nf">xlab</span><span class="p">(</span><span class="s">""</span><span class="p">)</span><span class="o">+</span><span class="nf">ylab</span><span class="p">(</span><span class="s">""</span><span class="p">)</span><span class="o">+</span><span class="nf">guides</span><span class="p">(</span><span class="n">fill</span><span class="o">=</span><span class="kc">FALSE</span><span class="p">)</span><span class="o">+</span><span class="nf">theme</span><span class="p">(</span><span class="n">plot.title</span><span class="o">=</span><span class="nf">element_text</span><span class="p">(</span><span class="n">face</span><span class="o">=</span><span class="s">"bold.italic"</span><span class="p">))</span><span class="o">+</span><span class="nf">theme_bw</span><span class="p">()</span><span class="o">+</span>
<span class="nf">theme</span><span class="p">(</span><span class="n">strip.text.x</span> <span class="o">=</span> <span class="nf">element_text</span><span class="p">(</span><span class="n">size</span> <span class="o">=</span> <span class="m">20</span><span class="p">,</span> <span class="n">color</span> <span class="o">=</span> <span class="s">"black"</span><span class="p">,</span> <span class="n">face</span> <span class="o">=</span> <span class="s">"bold.italic"</span><span class="p">))</span><span class="o">+</span>
<span class="nf">theme</span><span class="p">(</span><span class="n">strip.text.y</span> <span class="o">=</span> <span class="nf">element_text</span><span class="p">(</span><span class="n">size</span> <span class="o">=</span> <span class="m">15</span><span class="p">,</span> <span class="n">color</span> <span class="o">=</span> <span class="s">"black"</span><span class="p">,</span> <span class="n">face</span> <span class="o">=</span> <span class="s">"bold.italic"</span><span class="p">))</span><span class="o">+</span>
<span class="nf">ylim</span><span class="p">(</span><span class="m">-1.5</span><span class="p">,</span><span class="m">1.5</span><span class="p">)</span><span class="o">+</span>
<span class="nf">theme</span><span class="p">(</span><span class="n">plot.title</span><span class="o">=</span><span class="nf">element_text</span><span class="p">(</span><span class="n">face</span><span class="o">=</span><span class="s">"bold.italic"</span><span class="p">))</span>
<span class="n">fig2</span>
<span class="c1">#ggsave(plot=fig2,"./fig/2021-0514_fig2.pdf",width=20,height=6)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

</div>

<script type="application/vnd.jupyter.widget-state+json">
{"state": {}, "version_major": 2, "version_minor": 0}
</script>



  </div><!-- from https://github.com/utterance/utterances -->
<script src="https://utteranc.es/client.js"
        repo="miruetoto/hst2022"
        issue-term="title"
        label="blogpost-comment"
        theme="github-light"
        crossorigin="anonymous"
        async>
</script><a class="u-url" href="/hst2022/%EB%85%BC%EB%AC%B8%EC%97%B0%EA%B5%AC/2021/08/02/(%EC%97%B0%EA%B5%AC)-HST-example-1-(1)-%EB%85%BC%EB%AC%B8%EC%97%B0%EA%B5%AC.html" hidden></a>
</article>

      </div>
    </main><footer class="site-footer h-card">
  <data class="u-url" href="/hst2022/"></data>

  <div class="wrapper">

    <div class="footer-col-wrapper">
      <div class="footer-col">
        <p class="feed-subscribe">
          <a href="/hst2022/feed.xml">
            <svg class="svg-icon orange">
              <use xlink:href="/hst2022/assets/minima-social-icons.svg#rss"></use>
            </svg><span>Subscribe</span>
          </a>
        </p>
      </div>
      <div class="footer-col">
        <p></p>
      </div>
    </div>

    <div class="social-links"><ul class="social-media-list"></ul>
</div>

  </div>

</footer>
</body>

</html>
